<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>ê³ ì§€ê±°ë¶€ ì•ˆë‚´</title>
<style>
  :root {
    --back-fs: 0.9rem;     /* ë’¤ë¡œê°€ê¸° ë²„íŠ¼ í°íŠ¸ í¬ê¸° */
    --back-pad-v: 8px;     /* ë’¤ë¡œê°€ê¸° ë²„íŠ¼ ìˆ˜ì§ íŒ¨ë”© */
    --page-pad: 16px;      /* í˜ì´ì§€ ì¢Œìš° ì—¬ë°± (ë¡œê³ /ì œëª© ì •ë ¬ ê¸°ì¤€) */
  }

  /* ì „ì—­ íƒ€ì´í¬ & ëª¨ë°”ì¼ ê°€ë…ì„± */
  body { font-family: sans-serif; margin: 0; }
  body, h2, h3, p { word-break: keep-all; line-break: strict; line-height: 1.5; }

  /* ì€ì€í•œ ë„íŠ¸ ê·¸ë¦¬ë“œ ë°°ê²½ (ì½˜íŠ¸ë¼ìŠ¤íŠ¸ ë§¤ìš° ë‚®ìŒ) */
  body::before {
    content: "";
    position: fixed; inset: 0;
    background-image: radial-gradient(#000 0.5px, transparent 0.5px);
    background-size: 12px 12px;
    background-position: 0 0;
    opacity: 0.06;
    pointer-events: none;
    z-index: -1;
  }

  .page { padding: var(--page-pad); }
  .screen { display: none; }
  .active { display: block; }

  /* ìƒë‹¨ í—¤ë”: ë¡œê³  ì¢Œì¸¡, ë’¤ë¡œê°€ê¸° ìš°ì¸¡ (ë¡œê³ -ì œëª© ì¢Œì—´ ì¼ì¹˜) */
  .header {
    display: flex; align-items: center; justify-content: space-between;
    margin-bottom: 8px;
  }
  .logo-wrap { display: flex; align-items: center; gap: 8px; }
  .logo {
    display: block;
    height: calc(var(--back-fs) + (var(--back-pad-v) * 4)); 
    margin-left: -12px; /* ë¡œê³ ë¥¼ ì™¼ìª½ìœ¼ë¡œ ì•½ê°„ ì´ë™ */
  }

  /* ë²„íŠ¼ & ì…ë ¥ */
  .btn {
    display: block; width: 100%;
    margin: 8px 0; padding: 12px;
    font-size: 1.1rem; background: #f5f5f5;
    border: 1px solid #ccc; border-radius: 6px; color: #333; text-align: center;
  }
  .btn:active { background: #eee; }

  .back-btn {
    padding: var(--back-pad-v) 12px; font-size: var(--back-fs);
    color: #555; background: #f0f0f0; border: 1px solid #ccc; border-radius: 6px;
    margin-left: 8px;
  }

  input[type="text"] {
    display: block; width: 100%;
    margin: 8px 0; padding: 12px;
    font-size: 1.1rem; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box;
  }

  /* ì•ˆë‚´ë¬¸ / ì°¸ê³ ë¬¸ / ì˜¤ë¥˜ë¬¸ */
  .info-note {
    font-size: 1.17rem; font-weight: normal; color: #555;
    margin-top: 8px; white-space: pre-line;
  }
  .reference-note {
    font-size: 1.17rem; font-weight: normal; color: #555;
    margin-top: 4px; white-space: pre-line;
  }
  .error-note {
    color: #a40000; font-size: 0.95rem;
    margin-top: 4px; display: none;
  }

  /* 0ë‹¨ê³„: 2x2 ì •ì‚¬ê°í˜• ë²„íŠ¼ */
  .choice-btns {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
  }
  .choice-btns .btn {
    aspect-ratio: 1 / 1;    /* ê°€ë¡œ:ì„¸ë¡œ = 1:1 ì •ì‚¬ê°í˜• */
    padding: 0;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    border-radius: 12px;
    background: linear-gradient(to bottom, #f7f7f7, #f2f2f2);
    box-shadow: 0 2px 4px rgba(0,0,0,0.08);
  }
  .btn-icon {
    font-size: 2rem;
    color: #888;
    margin-bottom: 15px;
    line-height: 1;
  }
  .btn-text {
    font-size: 1.2rem;
    color: #333;
    white-space: pre-line; /* ì¤„ë°”ê¿ˆ í—ˆìš© */
    text-align: center;
  }

  /* 8ë‹¨ê³„ ê²°ê³¼ í…ìŠ¤íŠ¸ í¬ê¸° */
  #screen-8 p, #screen-8 #judge-text { font-size: 1.17rem; }
  #screen-8 .subtle, #screen-8 .info-note { font-size: 1rem; }

  /* ê²°ê³¼ ë°•ìŠ¤ì™€ í‘œ */
  .result-box {
    border: 1px solid #ddd; border-radius: 8px;
    padding: 12px; margin: 12px 0; background: #fafafa;
  }
  .result-ok { color: #126e00; font-weight: 700; }
  .result-no { color: #a40000; font-weight: 700; }

  .criteria-header {
    display: flex; justify-content: space-between; align-items: center;
    margin-top: 12px; margin-bottom: 8px;
  }
  .criteria-header .unit-label { font-size: 1rem; color: #555; }

  .criteria-table {
    width: 100%; border-collapse: collapse;
    margin-top: 4px; font-size: 1rem;
  }
  
  
  .criteria-table th, .criteria-table td {
    border: 1px solid #ccc; padding: 8px; text-align: center;
  }
  .criteria-table thead th { background: #f0f0f0; font-weight: 700; }
  .highlight { background: #e8f2ff; font-weight: 700; }

  /* 9ë‹¨ê³„ í‘œ */
  .evidence-table {
    width: 100%; border-collapse: collapse;
    margin-top: 8px; font-size: 0.95rem;
  }
  .evidence-table caption {
    font-size: 1.17rem; font-weight: 400; color: #555;
    margin-bottom: 8px; text-align: left;
  }
  .evidence-table th, .evidence-table td {
    border: 1px solid #ccc; padding: 8px;
    text-align: left; vertical-align: top;
  }
  .evidence-table th { background: #f0f0f0; }

  /* 11ë‹¨ê³„ ìº¡ì…˜ë§Œ 8ë‹¨ê³„ì™€ ë™ì¼ í¬ê¸°(1rem) */
  #criteria-note-guide {
    font-size: 1rem;
  }
  
</style>
</head>
<body>

<!-- 0ë‹¨ê³„: ì‹œì‘ ì„ íƒ -->
<section id="screen-0" class="screen active">
  <div class="page">
    <div class="header">
      <div class="logo-wrap">
        <img src="nts-logo.png" alt="êµ­ì„¸ì²­ ë¡œê³ " class="logo" />
      </div>
      <!-- 0ë‹¨ê³„ëŠ” ë’¤ë¡œê°€ê¸° ì—†ìŒ -->
    </div>
    <h2>ê³ ì§€ê±°ë¶€ ì•ˆë‚´</h2>
    <h3>ë¬´ì—‡ì„ í•˜ì‹œê² ì–´ìš”?</h3>

    <div class="choice-btns">
      <!-- ìƒì¢Œ: ê³ ì§€ê±°ë¶€ ì œë„ ì•ˆë‚´ -->
      <button class="btn" onclick="goTo(10)">
        <div class="btn-icon">ğŸ“…</div>
        <div class="btn-text">ì‹ ì²­ê¸°ê°„</div>
      </button>
      <!-- ìƒìš°: ê³ ì§€ê±°ë¶€ ìš”ê±´ íŒë‹¨ -->
      <button class="btn" onclick="goTo(1)">
        <div class="btn-icon">âœ…</div>
        <div class="btn-text">ìê°€ì§„ë‹¨</div>
      </button>
      <!-- í•˜ì¢Œ: ë…ë¦½ìƒê³„ ì†Œë“ê¸°ì¤€ ì•ˆë‚´ -->
      <button class="btn" onclick="goTo(11)">
        <div class="btn-icon">ğŸ“Š</div>
        <div class="btn-text">ë…ë¦½ìƒê³„<br>ì†Œë“ê¸°ì¤€</div>
      </button>
      <!-- í•˜ìš°: ì†Œë“ ì¢…ë¥˜ë³„ ì¦ë¹™ì„œë¥˜ ì•ˆë‚´ -->
      <button class="btn" onclick="goTo(9)">
        <div class="btn-icon">ğŸ“‘</div>
        <div class="btn-text">ì†Œë“ì¢…ë¥˜ë³„<br>ì¦ë¹™ì„œë¥˜</div>
      </button>
    </div>
  </div>
</section>

<!-- 1ë‹¨ê³„: ëŒ€ìƒì -->
<section id="screen-1" class="screen">
  <div class="page">
    <div class="header">
      <div class="logo-wrap">
        <img src="nts-logo.png" alt="êµ­ì„¸ì²­ ë¡œê³ " class="logo" />
      </div>
      <button class="back-btn" onclick="goTo(0)">â† ë’¤ë¡œê°€ê¸°</button>
    </div>
    <h2>ê³ ì§€ê±°ë¶€ ëŒ€ìƒì</h2>
    <h3>ê³ ì§€ê±°ë¶€ ëŒ€ìƒìë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</h3>
    <button class="btn" onclick="selectTarget('ë¶€ëª¨')">ë¶€ëª¨</button>
    <button class="btn" onclick="selectTarget('ìë…€')">ìë…€</button>
    <button class="btn" onclick="selectTarget('ë°°ìš°ì')">ë°°ìš°ì</button>
  </div>
</section>

<!-- 2ë‹¨ê³„: ì‚¬ìœ  -->
<section id="screen-2" class="screen">
  <div class="page">
    <div class="header">
      <div class="logo-wrap">
        <img src="nts-logo.png" alt="êµ­ì„¸ì²­ ë¡œê³ " class="logo" />
      </div>
      <button class="back-btn" onclick="goTo(1)">â† ë’¤ë¡œê°€ê¸°</button>
    </div>
    <h2>ê³ ì§€ê±°ë¶€ ì‚¬ìœ </h2>
    <h3>ê³ ì§€ê±°ë¶€ ì‚¬ìœ ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</h3>
    <div id="reason-buttons"></div>
  </div>
</section>

<!-- 3ë‹¨ê³„: ë™ì¼ì£¼ì†Œì§€/ë³„ë„ì„¸ëŒ€ ì§ˆë¬¸ -->
<section id="screen-3" class="screen">
  <div class="page">
    <div class="header">
      <div class="logo-wrap">
        <img src="nts-logo.png" alt="êµ­ì„¸ì²­ ë¡œê³ " class="logo" />
      </div>
      <button class="back-btn" onclick="goTo(2)">â† ë’¤ë¡œê°€ê¸°</button>
    </div>
    <h2>ì£¼ë¯¼ë“±ë¡í‘œìƒ ì£¼ì†Œì§€</h2>
    <h3 id="step3-question">ì§ˆë¬¸ì´ í‘œì‹œë©ë‹ˆë‹¤</h3>
    <button class="btn" onclick="answerStep3('ì—¬')">ì˜ˆ</button>
    <button class="btn" onclick="answerStep3('ë¶€')">ì•„ë‹ˆì˜¤</button>
  </div>
</section>

<!-- 4ë‹¨ê³„: ì•ˆë‚´ ì‚¬í•­ -->
<section id="screen-4" class="screen">
  <div class="page">
    <div class="header">
      <div class="logo-wrap">
        <img src="nts-logo.png" alt="êµ­ì„¸ì²­ ë¡œê³ " class="logo" />
      </div>
      <button class="back-btn" onclick="backFrom4()">â† ë’¤ë¡œê°€ê¸°</button>
    </div>
    <h2>ì•ˆë‚´ ì‚¬í•­</h2>
    <p id="notice-4" class="info-note"></p>
    <button id="btn-4-next" class="btn" onclick="goNextFrom4()">ë‹¤ìŒìœ¼ë¡œ</button>
    <button id="btn-4-home" class="btn" style="display:none" onclick="resetAll(); goTo(0)">ì²˜ìŒìœ¼ë¡œ</button>
  </div>
</section>

<!-- 5ë‹¨ê³„: ì„¸ëŒ€ì› ìˆ˜ -->
<section id="screen-5" class="screen">
  <div class="page">
    <div class="header">
      <div class="logo-wrap">
        <img src="nts-logo.png" alt="êµ­ì„¸ì²­ ë¡œê³ " class="logo" />
      </div>
      <button class="back-btn" onclick="goPrevInFlow()">â† ë’¤ë¡œê°€ê¸°</button>
    </div>
    <h2>ë…ë¦½ìƒê³„(ì„¸ëŒ€ì› ìˆ˜)</h2>
    <p id="notice-5" class="info-note"></p>
    <p id="notice-5-ref" class="reference-note" style="display:none;"></p>
    <input type="text" id="household-count" placeholder="ì„¸ëŒ€ì› ìˆ˜(1~10ëª…)" inputmode="numeric" maxlength="2" />
    <p id="hh-error" class="error-note">ì„¸ëŒ€ì› ìˆ˜ëŠ” 1~10ëª… ì‚¬ì´ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”. (ìµœëŒ€ 10ëª…)</p>
    <button class="btn" onclick="submitHousehold()">ë‹¤ìŒìœ¼ë¡œ</button>
  </div>
</section>

<!-- 6ë‹¨ê³„: ì§€ì—­ -->
<section id="screen-6" class="screen">
  <div class="page">
    <div class="header">
      <div class="logo-wrap">
        <img src="nts-logo.png" alt="êµ­ì„¸ì²­ ë¡œê³ " class="logo" />
      </div>
      <button class="back-btn" onclick="goPrevInFlow()">â† ë’¤ë¡œê°€ê¸°</button>
    </div>
    <h2>ë…ë¦½ìƒê³„(ì§€ì—­)</h2>
    <h3>ê³ ì§€ê±°ë¶€ ëŒ€ìƒìì˜ ì£¼ë¯¼ë“±ë¡í‘œìƒ ì£¼ì†Œì§€ê°€<br>ì, ë©´ì§€ì—­ì¸ê°€ìš”?</h3>
    <button class="btn" onclick="submitRegion(true)"><b>ì˜ˆ</b> (ì, ë©´ì§€ì—­)</button>
    <button class="btn" onclick="submitRegion(false)"><b>ì•„ë‹ˆì˜¤</b> (ë„ì‹œì§€ì—­)</button>
  </div>
</section>

<!-- 7ë‹¨ê³„: ì†Œë“ -->
<section id="screen-7" class="screen">
  <div class="page">
    <div class="header">
      <div class="logo-wrap">
        <img src="nts-logo.png" alt="êµ­ì„¸ì²­ ë¡œê³ " class="logo" />
      </div>
      <button class="back-btn" onclick="goPrevInFlow()">â† ë’¤ë¡œê°€ê¸°</button>
    </div>
    <h2>ë…ë¦½ìƒê³„(ì†Œë“)</h2>
    <h3 id="notice-7"></h3>
    <p id="notice-7-ref" class="reference-note" style="display:none;"></p>
    <input type="text" id="annual-income" placeholder="ì—°ê°„ ì†Œë“(ë‹¨ìœ„:ì›) ì…ë ¥" inputmode="numeric" />
    <button class="btn" onclick="submitIncome()">ë‹¤ìŒìœ¼ë¡œ</button>
  </div>
</section>

<!-- 8ë‹¨ê³„: ê²°ê³¼ -->
<section id="screen-8" class="screen">
  <div class="page">
    <div class="header">
      <div class="logo-wrap">
        <img src="nts-logo.png" alt="êµ­ì„¸ì²­ ë¡œê³ " class="logo" />
      </div>
      <button class="back-btn" onclick="goPrevInFlow()">â† ë’¤ë¡œê°€ê¸°</button>
    </div>
    <h2>ë…ë¦½ìƒê³„ ì†Œë“ìš”ê±´</h2>

    <!-- ìš”ì•½ -->
    <p>ê³ ì§€ê±°ë¶€ ëŒ€ìƒ: <strong id="sum-target">-</strong></p>
    <p>ê³ ì§€ê±°ë¶€ ì‚¬ìœ : <strong id="sum-reason">-</strong></p>
    <p id="sum-sameaddr-wrap" style="display:none;">
      <span id="sum-sameaddr-label"></span>: <strong id="sum-sameaddr"></strong>
    </p>
    <p>ì„¸ëŒ€ì› ìˆ˜: <strong id="sum-household">-</strong></p>
    <p>ìë©´ì§€ì—­ ì—¬ë¶€: <strong id="sum-urban">-</strong></p>
    <p>ì—°ê°„ ì†Œë“ê¸ˆì•¡: <strong id="sum-income">-</strong></p>

    <!-- íŒë‹¨ ê²°ê³¼ -->
    <div class="result-box" id="judge-box" style="display:none;">
      <div id="judge-text"></div>
      <div class="subtle" id="judge-detail" style="white-space:pre-line;"></div>
    </div>

    <!-- ê¸°ì¤€í‘œ: ë™ì  4ì—´ ì°½ -->
    <div class="criteria-header">
      <h3>ë…ë¦½ìƒê³„ ì›” ì†Œë“ê¸°ì¤€</h3>
      <span class="unit-label">(ë‹¨ìœ„: ì²œì›)</span>
    </div>
    <table id="criteria-table" class="criteria-table" style="display:none;"></table>
    <p id="criteria-note" class="info-note" style="display:none;">â€» ì—°ê°„ ì†Œë“ì„ 12ë¡œ ë‚˜ëˆ„ì–´ ì›”ì†Œë“ì„ ì‚°ì •</p>

    <!-- 8ë‹¨ê³„ ì¢…ë£Œ ë²„íŠ¼: ì²˜ìŒìœ¼ë¡œ(0ë‹¨ê³„) -->
    <button class="btn" onclick="resetAll(); goTo(0)">ì²˜ìŒìœ¼ë¡œ</button>
  </div>
</section>

<!-- 9ë‹¨ê³„: ì¦ë¹™ì„œë¥˜ ì•ˆë‚´ -->
<section id="screen-9" class="screen">
  <div class="page">
    <div class="header">
      <div class="logo-wrap">
        <img src="nts-logo.png" alt="êµ­ì„¸ì²­ ë¡œê³ " class="logo" />
      </div>
      <button class="back-btn" onclick="goTo(0)">â† ë’¤ë¡œê°€ê¸°</button>
    </div>
    <h2>ì¦ë¹™ì„œë¥˜ ì•ˆë‚´</h2>
    <p class="info-note">ê³ ì§€ê±°ë¶€ ì‹ ì²­ ì‹œ ë°˜ë“œì‹œ ì¦ë¹™ì„œë¥˜ë¥¼ ì²¨ë¶€í•´ì•¼ í•©ë‹ˆë‹¤.</p>

    <table class="evidence-table">
      <caption>ì†Œë“ í™•ì¸ì„ ìœ„í•œ ì¦ë¹™ì„œë¥˜(ì˜ˆì‹œ)</caption>
      <thead>
        <tr><th>ì†Œë“ìœ í˜•</th><th>ì¦ë¹™ì„œë¥˜</th></tr>
      </thead>
      <tbody>
        <tr><td>ë†ì—…ì†Œë“</td><td>ë†ì§€ëŒ€ì¥ ë˜ëŠ” ë†ì‚°ë¬¼ ì¶œí•˜ì¦ëª…</td></tr>
        <tr><td>ì‚¬ì—…ì†Œë“</td><td>ì†Œë“ê¸ˆì•¡ì¦ëª…ì›(ë˜ëŠ” ì›ì²œì§•ìˆ˜ì˜ìˆ˜ì¦) <b>and</b> ì‚¬ì—…ìë“±ë¡ì¦ëª…</td></tr>
        <tr><td>ê·¼ë¡œì†Œë“</td><td>ì†Œë“ê¸ˆì•¡ì¦ëª…ì›(ë˜ëŠ” ì›ì²œì§•ìˆ˜ì˜ìˆ˜ì¦) <b>and</b> ì¬ì§ì¦ëª…(ë˜ëŠ” ê±´ê°•ë³´í—˜ìê²©ë“ì‹¤í™•ì¸ì„œ)</td></tr>
        <tr><td>ì—°ê¸ˆì†Œë“</td><td>ì—°ê¸ˆìˆ˜ê¸‰ì¦ëª…ì„œ(ì§€ê¸‰ê°œì‹œì¼, ì›”ì§€ê¸‰ì•¡ì´ ê¸°ì¬ë˜ì–´ì•¼ í•¨)</td></tr>
        <tr><td>ê¸ˆìœµì†Œë“</td><td>í†µì¥ì‚¬ë³¸(1ë…„ ì´ìƒ ì •ê¸°ì ì¸ ê¸ˆìœµì†Œë“ì´ ë“œëŸ¬ë‚˜ì•¼ í•¨)</td></tr>
        <tr><td>ì„ëŒ€ì†Œë“</td><td>ì„ëŒ€ì°¨ê³„ì•½ì„œ <b>and</b> ì„ëŒ€ë£Œ í†µì¥ì‚¬ë³¸(1ë…„ ì´ìƒ)</td></tr>
        <tr><td>ì¬ì‚°ì†Œë“</td><td>ë“±ê¸°ë¶€(ë¶€ë™ì‚°), ì”ê³ ì¦ëª…ì„œ(ê¸ˆìœµ)</td></tr>
        <tr><td>ì†Œë“ì´ì „</td><td>ê³„ì¢Œì´ì²´ë‚´ì—­(1ë…„ ì´ìƒ ì •ê¸°ì ì¸ ì†¡ê¸ˆ)</td></tr>
      </tbody>
    </table>

    <button class="btn" onclick="resetAll(); goTo(0)">ì²˜ìŒìœ¼ë¡œ</button>
  </div>
</section>

<!-- 10ë‹¨ê³„: ê³ ì§€ê±°ë¶€ ì œë„ ì•ˆë‚´ (ì‹ ì²­ê¸°ê°„ í‘œ ë°˜ì˜) -->
<section id="screen-10" class="screen">
  <div class="page">
    <div class="header">
      <div class="logo-wrap">
        <img src="nts-logo.png" alt="êµ­ì„¸ì²­ ë¡œê³ " class="logo" />
      </div>
      <button class="back-btn" onclick="goTo(0)">â† ë’¤ë¡œê°€ê¸°</button>
    </div>
    <h2>ê³ ì§€ê±°ë¶€ ì‹ ì²­ê¸°ê°„</h2>
    <p class="info-note">
ê³ ì§€ê±°ë¶€ëŠ” ë“±ë¡ì˜ë¬´ìì˜ ë¶€ì–‘ì„ ë°›ì§€ ì•ŠëŠ” ì§ê³„ì¡´ë¹„ì†ì˜ ì¬ì‚°ê³ ì§€ë¥¼ ê±°ë¶€í•˜ëŠ” ì œë„ë¡œì„œ ë°˜ë“œì‹œ ì•„ë˜ ì‹ ì²­ê¸°ê°„ì— ì‹ ì²­í•˜ê³  ê³µì§ììœ¤ë¦¬ìœ„ì›íšŒì˜ í—ˆê°€ë¥¼ ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.
    </p>

    <table class="criteria-table">
      <thead>
        <tr>
          <th>êµ¬ ë¶„</th>
          <th>ì‹ ì²­ê¸°ê°„</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><b>ì •ê¸° ì‹ ì²­</b></td>
          <td><b>ë§¤ë…„ 1.1. ~ 1.31.</b></td>
        </tr>
        <tr>
          <td>ì¬ì‹¬ì‚¬ ì‹ ì²­</td>
          <td>ë§¤ë…„ 1.1. ~ 3.31.</td>
        </tr>
        <tr>
          <td>ìˆ˜ì‹œ ì‹ ì²­</td>
          <td>ìŠ¹ì§„ì¼, í‡´ì§ì¼ ë“±ìœ¼ë¡œë¶€í„° 1ê°œì›” ë‚´</td>
        </tr>
      </tbody>
    </table>

    <p id="criteria-note-guide" class="info-note">* ì¬ì‹¬ì‚¬ ì‹ ì²­ì€ <b>í—ˆê°€ê¸°ê°„ ì¤‘ì—ë§Œ</b> ì‹ ì²­ê°€ëŠ¥</p>

    <button class="btn" onclick="goTo(0)">ì²˜ìŒìœ¼ë¡œ</button>
  </div>
</section>

<!-- 11ë‹¨ê³„: ë…ë¦½ìƒê³„ ì†Œë“ê¸°ì¤€ ì•ˆë‚´ (1~4ì¸ê°€êµ¬ ê³ ì •í‘œ + ìº¡ì…˜ í°íŠ¸ í¬ê¸° ì¡°ì •) -->
<section id="screen-11" class="screen">
  <div class="page">
    <div class="header">
      <div class="logo-wrap">
        <img src="nts-logo.png" alt="êµ­ì„¸ì²­ ë¡œê³ " class="logo" />
      </div>
      <button class="back-btn" onclick="goTo(0)">â† ë’¤ë¡œê°€ê¸°</button>
    </div>
    <h2>ë…ë¦½ìƒê³„ ì†Œë“ê¸°ì¤€</h2>

    <div class="criteria-header">
      <h3>ë…ë¦½ìƒê³„ ì›” ì†Œë“ê¸°ì¤€</h3>
      <span class="unit-label">(ë‹¨ìœ„: ì²œì›)</span>
    </div>
    <table id="criteria-table-guide" class="criteria-table"></table>
    <p id="criteria-note-guide" class="info-note">â€» ì—°ê°„ ì†Œë“ì„ 12ë¡œ ë‚˜ëˆ„ì–´ ì›”ì†Œë“ì„ ì‚°ì •</p>

    <button class="btn" onclick="goTo(0)">ì²˜ìŒìœ¼ë¡œ</button>
  </div>
</section>

<script>
  /* ========= ìƒíƒœ ========= */
  let selectedTarget = '';       // ë¶€ëª¨ / ìë…€ / ë°°ìš°ì
  let reasonKey = '';            // 'ë…ë¦½ìƒê³„' | 'íƒ€ì¸ë¶€ì–‘' | 'ê¸°íƒ€' | '-'
  let reasonLabel = '';
  let sameAddr = '-';            // 'ì—¬' | 'ë¶€' | '-'
  let householdCount = null;     // ì •ìˆ˜(1~10)
  let isRural = null;            // true(ìÂ·ë©´=ë†ì´Œ) / false(ë„ì‹œ)
  let annualIncome = null;       // ì› ë‹¨ìœ„ ìˆ«ì

  let flow = [];                 // ì˜ˆ: [4,5,6,7,8] í˜¹ì€ [4]
  let fi = 0;                    // flow ì¸ë±ìŠ¤
  let backOrigin = 2;            // 4ë‹¨ê³„ì—ì„œ ë’¤ë¡œê°€ê¸°ì‹œ ëŒì•„ê°ˆ ë‹¨ê³„(1/2/3)

  /* 10 ì´ˆê³¼ ì…ë ¥ ì‹œ ì•ˆë‚´ë¥¼ ê³„ì† ë³´ì´ê²Œ í•˜ëŠ” í”Œë˜ê·¸ */
  let hhMaxExceededEver = false;

  /* ========= ì•ˆë‚´ë¬¸êµ¬ ========= */
  const GUIDE = {
    // 3ë‹¨ê³„ ì§ˆë¬¸
    step3_1: "ë¶€ì¹œê³¼ ëª¨ì¹œì´ ì£¼ë¯¼ë“±ë¡í‘œìƒ ë™ì¼ ì£¼ì†Œì§€ì— ê±°ì£¼í•˜ì‹œë‚˜ìš”?",
    step3_2: "ë¶€ëª¨ë‹˜ì„ ë¶€ì–‘í•˜ëŠ” íƒ€ì¸(í˜•ì œìë§¤ ë“±)ê³¼, ë¶€ëª¨ë‹˜ì´ ì£¼ë¯¼ë“±ë¡í‘œìƒ ë™ì¼ ì£¼ì†Œì§€ì— ê±°ì£¼í•˜ì‹œë‚˜ìš”?",
    step3_3: "ìë…€ê°€ ë“±ë¡ê¸°ì¤€ì¼ ì´ì „ 1ë…„ ì´ìƒ ì£¼ë¯¼ë“±ë¡ìƒ ë³„ë„ ì„¸ëŒ€ë¥¼ êµ¬ì„±í•˜ì˜€ë‚˜ìš”?",

    // 4ë‹¨ê³„ ì•ˆë‚´
    s4_1: "ë¶€ì¹œê³¼ ëª¨ì¹œì´ ì£¼ë¯¼ë“±ë¡í‘œìƒ ë™ì¼ ì£¼ì†Œì§€ì— ê±°ì£¼í•˜ëŠ” ê²½ìš°, ë¶€ì¹œ ë˜ëŠ” ëª¨ì¹œì´ ë…ë¦½ìƒê³„ ì†Œë“ìš”ê±´ì„ ì¶©ì¡±í•˜ë©´ ê³ ì§€ê±°ë¶€ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n\në‹¤ìŒìœ¼ë¡œ ì§„í–‰í•˜ë©´ ë…ë¦½ìƒê³„ ì†Œë“ìš”ê±´ì„ ìê°€ì§„ë‹¨í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    s4_2: "ë¶€ì¹œê³¼ ëª¨ì¹œì˜ ì£¼ë¯¼ë“±ë¡ìƒ ì£¼ì†Œì§€ê°€ ë‹¤ë¥¸ ê²½ìš°, ë¶€ì¹œê³¼ ëª¨ì¹œì´ ê°ê° ë…ë¦½ìƒê³„ ì†Œë“ìš”ê±´ì„ ì¶©ì¡±í•´ì•¼ ê³ ì§€ê±°ë¶€ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n\në‹¤ìŒìœ¼ë¡œ ì§„í–‰í•˜ë©´ ë…ë¦½ìƒê³„ ì†Œë“ìš”ê±´ì„ ìê°€ì§„ë‹¨í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    s4_3: "ë¶€ëª¨ë‹˜ì„ ë¶€ì–‘í•˜ëŠ” íƒ€ì¸(í˜•ì œìë§¤ ë“±)ê³¼, ë¶€ëª¨ë‹˜ì´ ì£¼ë¯¼ë“±ë¡í‘œìƒ ë™ì¼ ì£¼ì†Œì§€ì— ê±°ì£¼í•˜ëŠ” ê²½ìš°, ë¶€ëª¨ë‹˜ì„ ë¶€ì–‘í•˜ëŠ” íƒ€ì¸ì´ ë…ë¦½ìƒê³„ ì†Œë“ìš”ê±´ì„ ì¶©ì¡±í•˜ë©´ ê³ ì§€ê±°ë¶€ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n\në‹¤ìŒìœ¼ë¡œ ì§„í–‰í•˜ë©´ ë…ë¦½ìƒê³„ ì†Œë“ìš”ê±´ì„ ìê°€ì§„ë‹¨í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    s4_4: "ë¶€ëª¨ë‹˜ì„ ë¶€ì–‘í•˜ëŠ” íƒ€ì¸(í˜•ì œìë§¤ ë“±)ê³¼, ë¶€ëª¨ë‹˜ì´ ë‹¤ë¥¸ ì£¼ì†Œì§€ì— ê±°ì£¼í•˜ëŠ” ê²½ìš°, ë¶€ëª¨ë‹˜ê»˜ ë…ë¦½ìƒê³„ ì†Œë“ìš”ê±´ì„ ì¶©ì¡±í•˜ëŠ” ì†Œë“ì´ ì´ì „ë˜ì–´ì•¼(ê³„ì¢Œì´ì²´) ê³ ì§€ê±°ë¶€ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n\në‹¤ìŒìœ¼ë¡œ ì§„í–‰í•˜ë©´ ë…ë¦½ìƒê³„ ì†Œë“ìš”ê±´ì„ ìê°€ì§„ë‹¨í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    s4_5: "ì—°ë½ë‘ì ˆ, í–‰ë°©ë¶ˆëª…ëœ ì§ê³„ì¡´ë¹„ì†ì´ë‚˜ ì´í˜¼Â·ì¬í˜¼í•œ ì§ê³„ì¡´ì†ì¸ ê²½ìš°ë¡œì„œ ë“±ë¡ì˜ë¬´ìê°€ ë¶€ì–‘í•˜ì§€ ì•ŠìŒì„ ì…ì¦í•œ ê²½ìš° ê³ ì§€ê±°ë¶€ ê°€ëŠ¥í•©ë‹ˆë‹¤.\në‹¨ìˆœíˆ ê´€ê³„ê°€ ì†Œì›í•˜ë‹¤ë“ ì§€, ë¶ˆí™”ë¡œ ì¬ì‚°ë‚´ì—­ì„ í™•ì¸í•  ìˆ˜ ì—†ë‹¤ëŠ” ì‚¬ìœ ë¡œëŠ” ì‹ ì²­í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.",
    s4_6: "ìë…€ê°€ 1ë…„ ì´ìƒ ë³„ë„ ì„¸ëŒ€ë¥¼ êµ¬ì„±í•˜ê³ , ë…ë¦½ìƒê³„ ì†Œë“ìš”ê±´ì„ ì¶©ì¡±í•˜ë©´ ê³ ì§€ê±°ë¶€ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n\në‹¤ìŒìœ¼ë¡œ ì§„í–‰í•˜ë©´ ë…ë¦½ìƒê³„ ì†Œë“ìš”ê±´ì„ ìê°€ì§„ë‹¨í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    s4_7: "ìë…€ê°€ 1ë…„ ì´ìƒ ë³„ë„ ì„¸ëŒ€ë¥¼ êµ¬ì„±í•˜ì§€ ì•Šì•˜ë‹¤ë©´, ê³ ì§€ê±°ë¶€í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\n1ë…„ ì´ìƒ ë³„ë„ ì„¸ëŒ€ë¥¼ êµ¬ì„±í•œ ì´í›„ ê³ ì§€ê±°ë¶€ ì‹ ì²­í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.",
    s4_8: "ì´í˜¼í•œ ë°°ìš°ìê°€ ì–‘ìœ¡í•˜ëŠ” ë¯¸ì„±ë…„ ìë…€ëŠ”, ì´í˜¼í•œ ë°°ìš°ìë‚˜ ì–‘ë¶€ëª¨ê°€ ë…ë¦½ìƒê³„ ì†Œë“ê¸°ì¤€ì„ ì¶©ì¡±í•˜ëŠ” ê²½ìš° ê³ ì§€ê±°ë¶€ ê°€ëŠ¥í•©ë‹ˆë‹¤.\n\në‹¤ìŒìœ¼ë¡œ ì§„í–‰í•˜ë©´ ë…ë¦½ìƒê³„ ì†Œë“ìš”ê±´ì„ ìê°€ì§„ë‹¨í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    s4_9: "ë°°ìš°ì(ì‚¬ì‹¤í˜¼ í¬í•¨)ëŠ” ì¬ì‚°ë“±ë¡ ëŒ€ìƒì´ê³  ì´í˜¼í•œ ë°°ìš°ìëŠ” ì¬ì‚°ë“±ë¡ ëŒ€ìƒì´ ì•„ë‹™ë‹ˆë‹¤.",

    // 5ë‹¨ê³„ ì•ˆë‚´
    s5_1: "ë¶€ëª¨ë‹˜ì˜ ì£¼ë¯¼ë“±ë¡í‘œìƒ ëª¨ë“  ì„¸ëŒ€ì› ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.",
    s5_1_ref: "* ë“±ë¡ì˜ë¬´ì ë³¸ì¸ê³¼ ê·¸ ê°€ì¡±(ë°°ìš°ì, ì§ê³„ë¹„ì†)ì„ ì œì™¸í•©ë‹ˆë‹¤.",
    s5_2: "ë¶€ì¹œ ë˜ëŠ” ëª¨ì¹œì˜ ì£¼ë¯¼ë“±ë¡í‘œìƒ ì„¸ëŒ€ì› ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.",
    s5_2_ref: "* ë“±ë¡ì˜ë¬´ì ë³¸ì¸ê³¼ ê·¸ ê°€ì¡±(ë°°ìš°ì, ì§ê³„ë¹„ì†)ì„ ì œì™¸í•©ë‹ˆë‹¤.",
    s5_3: "ë¶€ëª¨ë‹˜ì˜ ì£¼ë¯¼ë“±ë¡í‘œìƒ ì„¸ëŒ€ì› ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.",
    s5_4: "ë¶€ëª¨ë‹˜ì˜ ì£¼ë¯¼ë“±ë¡í‘œìƒ ì„¸ëŒ€ì› ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.",
    s5_4_ref: "* ë¶€ëª¨ë‹˜ì„ ë¶€ì–‘í•˜ëŠ” íƒ€ì¸(í˜•ì œìë§¤)ì„ ì œì™¸í•©ë‹ˆë‹¤.",
    s5_5: "ìë…€ì˜ ì£¼ë¯¼ë“±ë¡í‘œìƒ ëª¨ë“  ì„¸ëŒ€ì› ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.",
    s5_6: "ìë…€ì˜ ì£¼ë¯¼ë“±ë¡í‘œìƒ ëª¨ë“  ì„¸ëŒ€ì› ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”.",
    s5_6_ref: "* ì´í˜¼í•œ ë°°ìš°ìë‚˜ ì–‘ë¶€ëª¨ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.",

    // 7ë‹¨ê³„ ì•ˆë‚´(ëŒ€ìƒë³„)
    s7_parents: "ë¶€ëª¨ë‹˜ì˜ ì—°ê°„ ì†Œë“ì„ ì…ë ¥í•©ë‹ˆë‹¤.",
    s7_parentOne: "ë¶€ì¹œ ë˜ëŠ” ëª¨ì¹œì˜ ì†Œë“ì„ ì…ë ¥í•©ë‹ˆë‹¤.",
    s7_caregiver: "ë¶€ëª¨ë‹˜ì„ ë¶€ì–‘í•˜ëŠ” íƒ€ì¸(í˜•ì œìë§¤)ì˜ ì†Œë“ì„ ì…ë ¥í•©ë‹ˆë‹¤.",
    s7_transfer: "ë¶€ëª¨ë‹˜ì„ ë¶€ì–‘í•˜ëŠ” íƒ€ì¸(í˜•ì œìë§¤)ì´ ë¶€ëª¨ë‹˜ì—ê²Œ ì´ì „í•œ ì†Œë“ì„ ì…ë ¥í•©ë‹ˆë‹¤.",
    s7_child: "ìë…€ì˜ ì†Œë“ê¸ˆì•¡ì„ ì…ë ¥í•©ë‹ˆë‹¤.",
    s7_guardian: "ìë…€ ì–‘ìœ¡ìì˜ ì†Œë“ê¸ˆì•¡ì„ ì…ë ¥í•©ë‹ˆë‹¤.",
    s7_common_ref:
      "* ìµœê·¼ ì†Œë“ê¸ˆì•¡ì¦ëª…ì› ê¸°ì¤€, ì‚¬ì—…ì†Œë“ì€ ì†Œë“ê¸ˆì•¡ìœ¼ë¡œ, ê·¼ë¡œÂ·ì—°ê¸ˆ ë“±ì€ ìˆ˜ì…ê¸ˆì•¡ìœ¼ë¡œ ì…ë ¥í•©ë‹ˆë‹¤.\n" +
      "* ê¸°íƒ€ ìì„¸í•œ ì‚¬í•­ì€ ê³ ì§€ê±°ë¶€ ì‹¬ì‚¬ê¸°ì¤€ ìš´ì˜ì§€ì¹¨ ì°¸ì¡°"
  };

  /* ========= 1~7ì¸ ê¸°ë³¸ í‘œ ê¸°ì¤€ ========= */
  const URBAN_BASE = [1435,2359,3015,3658,4264,4838,5392];
  const RURAL_BASE = [ 975,1604,2050,2487,2899,3289,3666];

  /* ========= ì‹œë‚˜ë¦¬ì˜¤ ë¼ìš°íŒ… ========= */
  const ROUTES = {
    'ë¶€ëª¨|ë…ë¦½ìƒê³„|ì—¬': { s4:'s4_1', s5:'s5_1', s5ref:'s5_1_ref', s7:'s7_parents', steps:[4,5,6,7,8], result:true },
    'ë¶€ëª¨|ë…ë¦½ìƒê³„|ë¶€': { s4:'s4_2', s5:'s5_2', s5ref:'s5_2_ref', s7:'s7_parentOne', steps:[4,5,6,7,8], result:true },
    'ë¶€ëª¨|íƒ€ì¸ë¶€ì–‘|ì—¬': { s4:'s4_3', s5:'s5_3', s5ref:null,        s7:'s7_caregiver', steps:[4,5,6,7,8], result:true },
    'ë¶€ëª¨|íƒ€ì¸ë¶€ì–‘|ë¶€': { s4:'s4_4', s5:'s5_4', s5ref:'s5_4_ref', s7:'s7_transfer',  steps:[4,5,6,7,8], result:true },
    'ë¶€ëª¨|ê¸°íƒ€|-':     { s4:'s4_5', steps:[4], result:false },
    'ìë…€|ë…ë¦½ìƒê³„|ì—¬': { s4:'s4_6', s5:'s5_5', s5ref:null, s7:'s7_child',    steps:[4,5,6,7,8], result:true },
    'ìë…€|ë…ë¦½ìƒê³„|ë¶€': { s4:'s4_7', steps:[4], result:false },
    'ìë…€|íƒ€ì¸ë¶€ì–‘|-':  { s4:'s4_8', s5:'s5_6', s5ref:'s5_6_ref', s7:'s7_guardian', steps:[4,5,6,7,8], result:true },
    'ë°°ìš°ì|-|-':       { s4:'s4_9', steps:[4], result:false }
  };

  /* ========= 1ë‹¨ê³„ ========= */
  function selectTarget(target) {
    selectedTarget = target;
    reasonKey = '';
    reasonLabel = '';
    sameAddr = '-';

    if (target === 'ë°°ìš°ì') {
      reasonKey = '-';
      reasonLabel = '-';
      sameAddr = '-';
      backOrigin = 1;
      startRoute();
      return;
    }

    const wrap = document.getElementById('reason-buttons');
    wrap.innerHTML = '';
    addReasonBtn('ë…ë¦½ìƒê³„','ë…ë¦½ì ìœ¼ë¡œ ìƒê³„ë¥¼ ìœ ì§€í•¨');
    addReasonBtn('íƒ€ì¸ë¶€ì–‘','íƒ€ì¸ì´ ë¶€ì–‘í•˜ê³  ìˆìŒ');
    if (target === 'ë¶€ëª¨') addReasonBtn('ê¸°íƒ€','ê¸°íƒ€');
    goTo(2);
  }
  function addReasonBtn(key, label) {
    const b = document.createElement('button');
    b.className = 'btn';
    b.textContent = label;
    b.onclick = () => selectReason(key, label);
    document.getElementById('reason-buttons').appendChild(b);
  }

  /* ========= 2ë‹¨ê³„ ========= */
  function selectReason(key, label) {
    reasonKey = key;
    reasonLabel = label;
    sameAddr = '-';
    if (needStep3(selectedTarget, reasonKey)) {
      document.getElementById('step3-question').innerText = getStep3Question(selectedTarget, reasonKey);
      backOrigin = 3;
      goTo(3);
    } else {
      backOrigin = 2;
      startRoute();
    }
  }
  function needStep3(target, key) {
    if (target === 'ë¶€ëª¨') return (key === 'ë…ë¦½ìƒê³„' || key === 'íƒ€ì¸ë¶€ì–‘');
    if (target === 'ìë…€') return (key === 'ë…ë¦½ìƒê³„');
    return false;
  }
  function getStep3Question(target, key) {
    if (target === 'ë¶€ëª¨' && key === 'ë…ë¦½ìƒê³„') return GUIDE.step3_1;
    if (target === 'ë¶€ëª¨' && key === 'íƒ€ì¸ë¶€ì–‘') return GUIDE.step3_2;
    if (target === 'ìë…€' && key === 'ë…ë¦½ìƒê³„') return GUIDE.step3_3;
    return 'ì§ˆë¬¸ì„ ì„ íƒí•´ ì£¼ì„¸ìš”';
  }

  /* ========= 3ë‹¨ê³„: ì¦‰ì‹œ ë¶„ê¸° ========= */
  function answerStep3(ans) {
    sameAddr = ans; // 'ì—¬' or 'ë¶€'
    startRoute();
  }

  /* ========= ë¼ìš°íŒ… ì‹œì‘ (4~) ========= */
  function startRoute() {
    const key = `${selectedTarget}|${reasonKey}|${sameAddr}`;
    const route = ROUTES[key] || { s4:'', steps:[4], result:false };
    flow = route.steps.slice();
    fi = 0;

    bindStepNotices(route);

    const terminal = (flow.length === 1 && flow[0] === 4);
    document.getElementById('btn-4-next').style.display = terminal ? 'none' : 'block';
    document.getElementById('btn-4-home').style.display = terminal ? 'block' : 'none';

    goTo(flow[fi]);
  }

  function bindStepNotices(route) {
    // 4ë‹¨ê³„
    document.getElementById('notice-4').innerText = GUIDE[route.s4] || '';

    // 5ë‹¨ê³„
    document.getElementById('notice-5').innerText = route.s5 ? GUIDE[route.s5] : '';
    const s5refEl = document.getElementById('notice-5-ref');
    if (route.s5ref && GUIDE[route.s5ref]) {
      s5refEl.style.display = 'block';
      s5refEl.innerText = GUIDE[route.s5ref];
    } else {
      s5refEl.style.display = 'none';
      s5refEl.innerText = '';
    }

    // 7ë‹¨ê³„
    const s7 = route.s7 ? GUIDE[route.s7] : '';
    document.getElementById('notice-7').innerText = s7 || '';
    const s7refEl = document.getElementById('notice-7-ref');
    if (s7) {
      s7refEl.style.display = 'block';
      s7refEl.innerText = GUIDE.s7_common_ref;
    } else {
      s7refEl.style.display = 'none';
      s7refEl.innerText = '';
    }
  }

  function backFrom4() { goTo(backOrigin); }
  function goNextFrom4() { nextInFlow(); }

  /* ========= íë¦„ ì´ë™ ========= */
  function goTo(step) {
    document.querySelectorAll('.screen').forEach(el => el.classList.remove('active'));
    const target = document.getElementById(`screen-${step}`);
    if (target) target.classList.add('active');

    if (step === 8) fillResult();
    if (step === 11) fillGuideCriteriaTable();
  }
  function goPrevInFlow() {
    if (flow.length === 0) return;
    if (fi > 0) { fi--; goTo(flow[fi]); }
    else { goTo(backOrigin); }
  }
  function nextInFlow() {
    if (fi < flow.length - 1) {
      fi++;
      goTo(flow[fi]);
    }
  }

  /* ========= 5ë‹¨ê³„: ì„¸ëŒ€ì› ìˆ˜ ì…ë ¥(1~10 ì œí•œ + ì½¤ë§ˆ + sticky ì˜¤ë¥˜) ========= */
  const hhInput = document.getElementById('household-count');
  const hhError = document.getElementById('hh-error');

  hhInput.addEventListener('input', e => {
    let digits = e.target.value.replace(/[^\d]/g,'');
    if (digits === '') {
      e.target.value = '';
      if (!hhMaxExceededEver) showHhError(false);
      return;
    }

    let n = Number(digits);
    if (isNaN(n)) {
      e.target.value = '';
      if (!hhMaxExceededEver) showHhError(false);
      return;
    }

    if (n > 10) {
      n = 10;
      hhMaxExceededEver = true;
      showHhError(true); // ì´í›„ì—ë„ ê³„ì† ë³´ì´ê²Œ
    } else if (n < 1) {
      n = 1;
      if (!hhMaxExceededEver) showHhError(true);
    } else {
      if (!hhMaxExceededEver) showHhError(false);
    }

    e.target.value = n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
  });

  function showHhError(show) {
    if (hhMaxExceededEver) {
      hhError.style.display = 'block';
    } else {
      hhError.style.display = show ? 'block' : 'none';
    }
  }

  function submitHousehold() {
    const raw = (hhInput.value || '').replace(/,/g,'').trim();
    const n = Number(raw);
    if (!raw || isNaN(n) || n < 1 || n > 10) {
      showHhError(true);
      hhInput.focus();
      return;
    }
    householdCount = n;
    nextInFlow();
  }

  /* ========= 6ë‹¨ê³„: ì§€ì—­ ========= */
  function submitRegion(isYes) { // ì˜ˆ=true(ìÂ·ë©´=ë†ì´Œ), ì•„ë‹ˆì˜¤=false(ë„ì‹œ)
    isRural = !!isYes;
    nextInFlow();
  }

  /* ========= 7ë‹¨ê³„: ì†Œë“(ì²œë‹¨ìœ„ ì½¤ë§ˆ) ========= */
  const incomeInput = document.getElementById('annual-income');
  incomeInput.addEventListener('input', e => {
    let v = e.target.value.replace(/[^\d]/g,'');
    e.target.value = v ? Number(v).toLocaleString() : '';
  });
  function submitIncome() {
    const raw = (incomeInput.value || '').replace(/,/g,'').trim();
    const n = Number(raw);
    if (isNaN(n) || n < 0) { alert('ìœ íš¨í•œ ì—°ê°„ ì†Œë“ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'); return; }
    annualIncome = n;
    nextInFlow();
  }

  /* ========= 8ë‹¨ê³„: ê²°ê³¼ & í‘œ(ë™ì  4ì—´ / 8ì¸ ì´ìƒ í™•ì¥ / 4ì˜ ë°°ìˆ˜ ì°½) ========= */
  function baseThreshold(k, rural) {
    if (!rural) { // ë„ì‹œ
      if (k <= 7) return URBAN_BASE[k-1];
      // 7ì¸ê°€êµ¬ ì´ˆê³¼: 1ì¸ë‹¹ 554ì²œì› ì¦ê°€
      return 5392 + (k - 7) * 554;
    } else {      // ë†ì´Œ
      if (k <= 7) return RURAL_BASE[k-1];
      // 7ì¸ê°€êµ¬ ì´ˆê³¼: 1ì¸ë‹¹ 377ì²œì› ì¦ê°€
      return 3666 + (k - 7) * 377;
    }
  }

  function fillResult() {
    // ìš”ì•½
    document.getElementById('sum-target').innerText = selectedTarget || '-';
    document.getElementById('sum-reason').innerText = reasonLabel || '-';

    const sameWrap = document.getElementById('sum-sameaddr-wrap');
    const sameLabel = document.getElementById('sum-sameaddr-label');
    const sameValue = document.getElementById('sum-sameaddr');

    sameWrap.style.display = 'none';

    const isParent = (selectedTarget === 'ë¶€ëª¨');
    const isChild  = (selectedTarget === 'ìë…€');
    const isIndep  = (reasonKey === 'ë…ë¦½ìƒê³„');
    const isCare   = (reasonKey === 'íƒ€ì¸ë¶€ì–‘');

    if (isParent && (isIndep || isCare)) {
      sameLabel.innerText = 'ë™ì¼ ì£¼ì†Œì§€ ì—¬ë¶€';
      sameValue.innerText = (sameAddr === 'ì—¬') ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤';
      sameWrap.style.display = 'block';
    } else if (isChild && isIndep) {
      sameLabel.innerText = '1ë…„ ì´ìƒ ë³„ë„ì„¸ëŒ€ ì—¬ë¶€';
      sameValue.innerText = (sameAddr === 'ì—¬') ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤';
      sameWrap.style.display = 'block';
    }

    document.getElementById('sum-household').innerText = (householdCount==null)?'-':`${householdCount}ëª…`;
    document.getElementById('sum-urban').innerText     = (isRural==null)?'-':(isRural?'ì˜ˆ(ìÂ·ë©´ì§€ì—­)':'ì•„ë‹ˆì˜¤(ë„ì‹œì§€ì—­)');
    document.getElementById('sum-income').innerText    = (annualIncome==null)?'-':`${annualIncome.toLocaleString()} ì›`;

    const judgeBox = document.getElementById('judge-box');
    const criteriaTable = document.getElementById('criteria-table');
    const criteriaNote  = document.getElementById('criteria-note');

    const key = `${selectedTarget}|${reasonKey}|${sameAddr}`;
    const route = ROUTES[key];
    const needResult = route && route.result;

    if (!needResult) {
      judgeBox.style.display = 'none';
      criteriaTable.style.display = 'none';
      criteriaNote.style.display = 'none';
      return;
    }

    judgeBox.style.display = 'block';
    criteriaTable.style.display = 'table';
    criteriaNote.style.display = 'block';

    // ê³„ì‚°
    const n = Math.max(1, Number(householdCount || 1));
    const monthlyK = Math.round(annualIncome / 1000 / 12);
    const needK = baseThreshold(n, isRural);
    const regionName = isRural ? 'ë†ì´Œì§€ì—­' : 'ë„ì‹œì§€ì—­';

    // ê²°ê³¼ ë¬¸êµ¬
    const judgeText = document.getElementById('judge-text');
    const ok = monthlyK >= needK;
    judgeText.className = ok ? 'result-ok' : 'result-no';
    judgeText.innerText = ok
      ? `${n}ì¸ ê°€êµ¬ ì†Œë“ê¸°ì¤€ì„ ì¶©ì¡±í•˜ì—¬ ê³ ì§€ê±°ë¶€ ê°€ëŠ¥í•©ë‹ˆë‹¤.`
      : `${n}ì¸ ê°€êµ¬ ì†Œë“ê¸°ì¤€ì„ ì¶©ì¡±í•˜ì§€ ëª»í•˜ì—¬ ê³ ì§€ê±°ë¶€ ëŒ€ìƒì´ ì•„ë‹™ë‹ˆë‹¤.`;

    // ìƒì„¸ ë¹„êµ
    document.getElementById('judge-detail').innerText =
      `${regionName} ${n}ì¸ê°€êµ¬ ê¸°ì¤€ : ì›” ${comma(needK)}ì²œì›\n` +
      `ë“±ë¡ì˜ë¬´ì : ì›” ${comma(monthlyK)}ì²œì› (ì—° ${comma(Math.round(annualIncome/1000))}ì²œì›)`;

    // í‘œ ë™ì  4ì—´ ì°½ (ì„¸ëŒ€ì› ìˆ˜ ê¸°ì¤€ìœ¼ë¡œ ì°½ ì´ë™, 4ì˜ ë°°ìˆ˜)
    let startCol = Math.floor((n - 1) / 4) * 4 + 1;
    let endCol = startCol + 3;

    const headCells = ['<th>êµ¬ë¶„</th>'];
    for (let k = startCol; k <= endCol; k++) headCells.push(`<th>${k}ì¸ê°€êµ¬</th>`);
    const thead = `<thead><tr>${headCells.join('')}</tr></thead>`;

    const rowUrban = ['<th>ë„ì‹œì§€ì—­(2025ë…„)</th>'];
    const rowRural = ['<th>ë†ì´Œì§€ì—­(2025ë…„)</th>'];
    for (let k = startCol; k <= endCol; k++) {
      rowUrban.push(`<td>${comma(baseThreshold(k, false))}</td>`);
      rowRural.push(`<td>${comma(baseThreshold(k, true))}</td>`);
    }
    criteriaTable.innerHTML = thead + `<tbody><tr id="row-urban">${rowUrban.join('')}</tr><tr id="row-rural">${rowRural.join('')}</tr></tbody>`;

    // í•˜ì´ë¼ì´íŠ¸
    document.querySelectorAll('#criteria-table td, #criteria-table th').forEach(el => el.classList.remove('highlight'));
    if (n >= startCol && n <= endCol) {
      const colOffset = n - startCol;
      const row = isRural ? document.getElementById('row-rural') : document.getElementById('row-urban');
      const tds = row.querySelectorAll('td');
      if (tds[colOffset]) tds[colOffset].classList.add('highlight');
    }
  }

  function comma(x) {
    const s = String(x), p = s.split('.');
    p[0] = p[0].replace(/\B(?=(\d{3})+(?!\d))/g, ',');
    return p.join('.');
  }

  /* ========= 11ë‹¨ê³„: ê³ ì • 1~4ì¸ê°€êµ¬ í‘œ ========= */
  function fillGuideCriteriaTable() {
    const table = document.getElementById('criteria-table-guide');
    const startCol = 1;
    const endCol = 4;

    const headCells = ['<th>êµ¬ë¶„</th>'];
    for (let k = startCol; k <= endCol; k++) headCells.push(`<th>${k}ì¸ê°€êµ¬</th>`);
    const thead = `<thead><tr>${headCells.join('')}</tr></thead>`;

    const rowUrban = ['<th>ë„ì‹œì§€ì—­(2025ë…„)</th>'];
    const rowRural = ['<th>ë†ì´Œì§€ì—­(2025ë…„)</th>'];
    for (let k = startCol; k <= endCol; k++) {
      rowUrban.push(`<td>${comma(baseThreshold(k, false))}</td>`);
      rowRural.push(`<td>${comma(baseThreshold(k, true))}</td>`);
    }
    table.innerHTML = thead + `<tbody><tr>${rowUrban.join('')}</tr><tr>${rowRural.join('')}</tr></tbody>`;
  }

  /* ========= ê³µí†µ ========= */
  function resetAll() {
    selectedTarget = ''; reasonKey = ''; reasonLabel = '';
    sameAddr = '-'; householdCount = null; isRural = null; annualIncome = null;
    flow = []; fi = 0; backOrigin = 2;
    hhMaxExceededEver = false;

    const hhEl = document.getElementById('household-count');
    if (hhEl) hhEl.value = '';
    const incEl = document.getElementById('annual-income');
    if (incEl) incEl.value = '';

    const n4 = document.getElementById('notice-4');
    if (n4) n4.innerText = '';
    const n5 = document.getElementById('notice-5');
    if (n5) n5.innerText = '';
    const n5r = document.getElementById('notice-5-ref');
    if (n5r) n5r.innerText = '';
    const n7 = document.getElementById('notice-7');
    if (n7) n7.innerText = '';
    const n7r = document.getElementById('notice-7-ref');
    if (n7r) n7r.innerText = '';

    const err = document.getElementById('hh-error');
    if (err) err.style.display = 'none';
  }
</script>
</body>
</html>
